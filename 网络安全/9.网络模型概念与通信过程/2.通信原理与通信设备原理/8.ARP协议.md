- 获取目标IP对应的mac地址，用来封装帧头
  - 数据到达网络层后，网络层先查找ARP缓存中有没有目标IP对应的 mac地址
    - 如果有，直接交给 数据链路层进行封装
    - 如果没有，发送ARP请求，获取目标IP的 MAC地址，然后进行缓存

- ARP的发送流程
  - **只能局域网发送，发送的方式是广播**
    - ARP是网络层产生的，并且没有经过IP协议的封装，所以是没有目标IP这个东西的
    - 而路由器就是根据目标IP进行数据的发送，没有目标IP，就发送不了，所以ARP协议只能在局域网内进行广播
  - 目标mac地址是 FFFFFF，并且报文中含有IP信息
  - 交换机一看是 6个F，就会给所有的接口都发送一遍
  - 接收后，如果IP是自己的IP，就会响应自己的 mac地址
  - 接收到mac地址后，进行缓存，并构建 数据帧 进行发送

- 如果是跨网段发送
  - 网络层一看，目标IP不是同一个网段，则获取的是网关的mac地址（先看缓存，在发ARP）
    - ARP中携带的是网关IP，交换机广播后，路由器接收到ARP报文，一看IP是自己的IP，于是就响应自己的mac地址
  - PC拿到 路由器的mac地址后，就封装形成数据帧，进行发送
    - 此时目标mac地址是路由器的，但是目标IP还是原来的（并不是路由器的IP）
  - 交换机不管目标IP是不是路由器的（看不到这层数据），但是目标mac地址是路由器的，于是就把数据包推给了网关
  - **此时数据包就到达了网关**


- arp -a  可以查看arp缓存表
- arp -d  可以清空arp缓存表
- 缓存表每个一段时间会自动更新一次（时间不是很长，也就几分钟，被称为老化时间）