#### 概念与作用
- Vlan（虚拟局域网），可以把一个局域网下的用户，进行分组
- 作用：减少广播量，同一组内的用户可以通信，也就是广播只能以组为单位，进行广播（**隔离广播**）
  - 比如：局域网下有20台电脑
    - 如果不使用Vlan，则广播20台电脑
    - 如果使用了Vlan，10个为一组，则广播10台电脑

- 路由器也能隔离广播，但是有一定的缺点
  - 不够灵活
  <img src='https://lsz.net.cn/node/imgs/ece93ba7668dfa523be5b4e4afa30310.png' />
    - 只要在交换机2，就是一组。只要在交换机1，就是另一组
    - 无法实现，自定义让某台用户，归属于哪一组
      - 比如：交换机2上的某个用户，就想让它归属于组一，是无法实现的（Vlan可以）
  - 只要新创建一个组，就需要购买交换机和路由器（成本增加）


#### 原理
- 启用Vlan后，交换机上就会出现一个 Vlan表。格式大概为 F4 ---> V1、F5 ---> V2
  - F4接口属于第一组，F5接口属于第二组
  - 由于是手动配置的，所以可以实现，自定义让某台用户，归属于哪一组
- 隔离广播域的原理
  - 数据帧从接口进入交换机的时候，由于接口已经分好组了，所以就知道了这个数据帧，该在哪一个组内进行广播
  - 只会把数据帧发往属于同一组的接口（没分组之前是所有接口都会发送）

- Vlan表的格式大概有几种（其他的都淘汰了）
  - Vlan ---> 端口（静态配置，电脑换位置，所处的分组也会发生变化，用的端口属于哪一组就是哪一组）
  - Vlan ---> mac地址（动态配置，电脑换位置，所处的分组不变，换位置mac地址又不会发生变化，所以分组不变）
  - Vlan ---> 账户（动态配置，最新技术，比较难搞）

#### 扩展
- **既然采用了Vlan分组，每一组互不通信，每一组就可以定义不同的网段**（便于管理）
  - 比如，不知道这个用户属于哪一组（除非查Vlan表）
  - 如果，每一组的网段不同，查看用户的IP就可以知道该用户属于哪一组，也能知道两个用户是否属于同一组
    - **两个组的网段也可以一样**，但是这样就不容易区分，用户属于哪一组
    - 网段一样，两个Vlan组无法通信（ping不通）
    - 网段不一样，会找路由器，路由器可以转发到另一个Vlan组，实现通信（单臂路由、三层交换机）
      - Vlan隔离的是广播，不能隔离正常通信（这也是Vlan隔离通信，为什么又想办法通过路由器进行通信的原因）
      - 广播是无法通过路由器的，没有IP协议，路由器不会发送
- 每一组定义不同网段的原理
  - 同一个交换机的用户，如何得到不同的网段，正确的网段
  - 电脑一般都是自动从DHCP服务器获取IP，采用广播的形式，这样就可以利用Vlan进行隔离区分
  - 每一个Vlan组，创建一个DHCP服务器，比如：
    - V1 --> DHCP1。该DHCP服务器分配的网段为 192.3.4.0/24
    - V2 --> DHCP2。该DHCP服务器分配的网段为 192.3.5.0/24
  - 受Vlan的限制，广播只能组内广播，这样：
    - V1组的广播只能广播到DHCP1，从而获取的网段为192.3.4.0/24
    - V2组的广播只能广播到DHCP2，从而获取的网段为192.3.5.0/24
  - 这样，两个组中的用户，获取的网段就不一样了
    - 同一组内的用户相同



#### 后续技术的支持
- Trunk和单臂路由