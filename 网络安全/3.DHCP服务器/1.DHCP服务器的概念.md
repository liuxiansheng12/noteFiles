#### 作用
- 这是一个给客户机自动分配IP的服务器
  - 默认使用的端口是UDP67和UDP68
  - 这两个端口是正常的DHCP服务端口，可以理解为一个发送，一个接收


- 每一个DHCP都有一个IP池
  - 当有客户机需要IP的时候，就从IP池里拿一个IP，给客户机使用
  - **并且，每一个IP都有一个使用时间**
  - 当时间一到，这个IP就会被收回，客户机会自动续约，延长使用时间


#### 客户机自动获取IP的流程
- **第一步**：客户机发送 Discover 报文，通知DHCP服务器我需要IP地址
  - 由于客户机并不清楚DHCP的IP地址，所以，会采用广播的形式发出
- **第二步**：DHCP服务器发送一个 Offer 报文
  - 如果局域网内有多个 DHCP 服务器，都会接收到 Discover，然后发送 Offer 报文
  - 也就是客户机可能接收到多个 Offer 报文
  - 遵循的原则是，那个 Offer 报文先到，就使用那个。
- **第三步**：客户机 Request 报文（广播的形式发出）
  - 报文中包含，DHCP服务器的IP地址和该服务器分配给自己的IP地址
- **第四步**：DHCP服务器给客户机响应一个 ACK 报文（**IP分配完成**）
  - DHCP服务器收到 Request 报文后，判断报文中的DHCP服务器IP地址是否与自己的地址相同（Request 报文是广播发送，所有的DHCP服务器都会收到，进行相应处理）。
    - 如果相同，说明客户机采用的是自己分配给他的IP地址，才会响应 ACK 报文。
    - 如果不同，说明客户机使用的是其他DHCP服务器分配的地址，则自己分配的IP地址就会放回IP池中，为下一个电脑服务
  - ACK 报文中就包含具体的信息了，比如使用时间，网关地址，DNS地址等等（信息已经完成，可以正常用了）

- 客户机接收到 ACK 报文后，检查DHCP服务器分配的IP地址是否可以使用（可能是个坏的）



#### 续约流程
- 每一个IP都有一个时间限制，如果时间快到了，就会自动往对应的DHCP服务器，发送续约请求
- DHCP服务器接收到续约请求，就会延长收回的时间
  - 延长的时间，就是IP默认使用的时间
- 如果此时电脑离开了网络，就无法发送续约请求，时间一到DHCP，就把IP收回，放回到IP池中，供下一个客户使用

#### 地址的释放
- 客户机在成功获取IP地址后，随时可以通过发送 Release 报文释放自己的IP地址
  - DHCP服务器，接收到这个报文，就会把IP放回地址池中。


#### IP保留
- IP会进行保留
  - **时间没到，IP就不会被DHCP收回，即使客户已经下线**
- 如果IP，没有被收回，客户又连上了，还是使用这个IP